[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --infname test/paired-data/all-seqs.fa --parameter-dir test/paired/new-results/test/parameters/data --n-max-queries 100 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m /home/dralph/work/partis/bin/extract-pairing-info.py test/paired-data/all-seqs.fa /tmp/dralph/hmms/63811/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after sorting alphabetically by droplet id) which had 100 / 100 seqs
  extract_pairing_info(): read 100 sequences with 48 droplet ids
    droplet id separators (set automatically): _  indices: [0]
       e.g. uid 'AAACCTGAGAGACGAA-1_contig_2' --> droplet id 'AAACCTGAGAGACGAA-1' contig id '2'
    contigs per
      droplet     count   fraction
        1            2     0.042
        2           42     0.875
        3            2     0.042
        4            2     0.042
[91mrun[0m /home/dralph/work/partis/bin/split-loci.py test/paired-data/all-seqs.fa --outdir /tmp/dralph/hmms/63811 --input-metafname /tmp/dralph/hmms/63811/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after sorting alphabetically by droplet id) which had 100 / 100 seqs
  --input-metafnames: added meta info for 100 sequences from /tmp/dralph/hmms/63811/meta.yaml: paired-uids
    read pairing info for 100 seqs from input meta file
  running vsearch on 100 sequences:
    igh:   50 / 100 v annotations (50 failed) with 31 v genes in 0.1 sec
    igk:   39 / 100 v annotations (61 failed) with 20 v genes in 0.1 sec
    igl:   17 / 100 v annotations (83 failed) with 15 v genes in 0.1 sec
totals: igh 48 igk 37 igl 15
  removed 0 failed uids from paired_uids
            count  frac  paired with
       [94mh[0m      31   0.65   [95mk[0m
              11   0.23   [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [95mk[0m
               1   0.02   [92ml[0m [92ml[0m
               1   0.02   [95mk[0m [92ml[0m
       [95mk[0m      31   0.84   [94mh[0m
               2   0.05   
               2   0.05   [94mh[0m [94mh[0m [95mk[0m
               1   0.03   [94mh[0m [92ml[0m
               1   0.03   [94mh[0m [94mh[0m [92ml[0m
       [92ml[0m      11   0.73   [94mh[0m
               2   0.13   [94mh[0m [92ml[0m
               1   0.07   [94mh[0m [95mk[0m
               1   0.07   [94mh[0m [94mh[0m [95mk[0m
writing to /tmp/dralph/hmms/63811/
  igh: 48 to 63811/igh.fa
  igk: 37 to 63811/igk.fa
  igl: 15 to 63811/igl.fa
writing to paired subdirs
    36/48 igh seqs pair with igk
      igh: 36 to igh+igk/igh.fa
      igk: 37 to igh+igk/igk.fa
    15/48 igh seqs pair with igl
      igh: 15 to igh+igl/igh.fa
      igl: 15 to igh+igl/igl.fa
[44mcache-parameters[0m [94migh[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --infname /tmp/dralph/hmms/63811/igh.fa --parameter-dir test/paired/new-results/test/parameters/data/igh --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igh/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/63811/meta.yaml
  --input-metafnames: added meta info for 48 sequences from /tmp/dralph/hmms/63811/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 29 v genes in 0.1 sec
    keeping 23 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igh/sw (1.8 sec)
    water time: 2.1  (ig-sw 1.9  processing 0.2)
  writing hmms (0.2 sec)
hmm
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igh/hmm (1.6 sec)
         infra time: 1.7
      hmm step time: 2.1
  writing hmms (0.2 sec)
      total time: 5.3
[44mcache-parameters[0m [94migk[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --infname /tmp/dralph/hmms/63811/igk.fa --parameter-dir test/paired/new-results/test/parameters/data/igk --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igk/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/63811/meta.yaml
  --input-metafnames: added meta info for 37 sequences from /tmp/dralph/hmms/63811/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 17 v genes in 0.1 sec
    keeping 16 / 58 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.0 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igk/sw (1.4 sec)
    water time: 1.6  (ig-sw 1.4  processing 0.1)
  writing hmms (0.1 sec)
hmm
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igk/hmm (1.1 sec)
         infra time: 1.2
      hmm step time: 1.5
  writing hmms (0.1 sec)
      total time: 3.8
[44mcache-parameters[0m [94migl[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --infname /tmp/dralph/hmms/63811/igl.fa --parameter-dir test/paired/new-results/test/parameters/data/igl --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igl/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/63811/meta.yaml
  --input-metafnames: added meta info for 15 sequences from /tmp/dralph/hmms/63811/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 13 v genes in 0.1 sec
    keeping 10 / 70 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igl/sw (0.9 sec)
    water time: 1.0  (ig-sw 0.9  processing 0.1)
  writing hmms (0.1 sec)
hmm
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igl/hmm (0.7 sec)
         infra time: 0.7
      hmm step time: 0.9
  writing hmms (0.1 sec)
      total time: 2.5
      [93mwarning[0m expected to remove 1/11 files+dirs that weren't in /tmp/dralph/hmms/63811/: failed.fa
      total time: 13.3
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results/test/parameters/data --n-sim-events 10 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/test/simu --indel-frequency 0.2
    cleaning paired files in test/paired/new-results/test/simu/
[94migh+igk[0m: simulating 7 events
[44mgenerate-trees[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 7 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 177687104 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 7 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 7 trees:   depth 0.04044   leaves 8.29
    writing trees to test/paired/new-results/test/simu/igh+igk/trees.nwk
      total time: 1.2
[44msimulate[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 177687104 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igk/igh.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 6
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/844032/trees-sub-6.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 4
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/844032/trees-sub-4.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/844032/trees-sub-1.nwk
    made 1 event with 4 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 3
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/844032/trees-sub-3.nwk
    made 1 event with 6 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 5
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/844032/trees-sub-5.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/844032/trees-sub-2.nwk
    made 1 event with 14 seqs in 0.3s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/844032/trees-sub-0.nwk
    made 1 event with 20 seqs in 0.3s (0.3s of which was running bppseqgen)
      total time: 0.6

   read 7 events with 58 seqs from 7 .yaml files
      total time: 1.2
[44msimulate[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igk --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 298017927 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igk/igk.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 4
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/581552/trees-sub-4.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 6
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/581552/trees-sub-6.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 3
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/581552/trees-sub-3.nwk
    made 1 event with 6 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/581552/trees-sub-1.nwk
    made 1 event with 4 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/581552/trees-sub-2.nwk
    made 1 event with 14 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 5
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/581552/trees-sub-5.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.4

      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/581552/trees-sub-0.nwk
    made 1 event with 20 seqs in 0.3s (0.3s of which was running bppseqgen)
      total time: 0.6

   read 7 events with 58 seqs from 7 .yaml files
      total time: 1.2
[94migh+igl[0m: simulating 3 events
[44mgenerate-trees[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 3 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 172687121 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 3 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 3 trees:   depth 0.00000   leaves 1.67
    writing trees to test/paired/new-results/test/simu/igh+igl/trees.nwk
      total time: 1.2
[44msimulate[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 172687121 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igl/igh.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/331422/trees-sub-0.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.3

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/331422/trees-sub-1.nwk
    made 1 event with 2 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/331422/trees-sub-2.nwk
    made 1 event with 2 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.4

   read 3 events with 5 seqs from 3 .yaml files
      total time: 0.9
[44msimulate[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igl --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1456246501 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igl/igl.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/841436/trees-sub-1.nwk
    made 1 event with 2 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.3

      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/841436/trees-sub-0.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/841436/trees-sub-2.nwk
    made 1 event with 2 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.3

   read 3 events with 5 seqs from 3 .yaml files
      total time: 0.9
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igl/
  apportioned 126 seqs among 42 droplets (mean/2 1.5): 2 2 2 4 4 2 4 4 4 4 2 2 2 4 2 2 4 2 4 2 4 2 4 2 4 2 4 4 2 4 2 4 4 4 2 4 4 2 2 4 2 2
  removed 18 / 126 = 0.14 seqs from outfos (leaving 6 / 108 unpaired)
      total time: 8.6
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 52 / 52 v annotations (0 failed) with 5 v genes in 0.1 sec
    keeping 5 / 220 v genes
    [91mmissing[0m 18 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-46[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-48[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-66[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-7[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-39[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m02[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 52 / 52 v annotations (0 failed) with 5 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    running 10 procs for 52 seqs
    running 11 procs for 2 seqs
      info for 52 / 52 = 1.000   (removed: 0 failed)
      kept 20 (0.385) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 52 / 52 v annotations (0 failed) with 5 v genes in 0.1 sec
    running 10 procs for 52 seqs
    running 11 procs for 2 seqs
      info for 52 / 52 = 1.000   (removed: 0 failed)
      kept 20 (0.385) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igh/sw (0.6 sec)
    water time: 0.9  (ig-sw 0.7  processing 0.1)
  writing hmms (0.1 sec)
hmm
    reading output
        read 52 hmm output lines with 52 sequences in 52 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/hmm (0.4 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/true (0.4 sec)
         infra time: 0.8
      hmm step time: 1.2
  writing hmms (0.1 sec)
      total time: 2.8
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 52 / 52 v annotations (0 failed) with 7 v genes in 0.0 sec
    keeping 7 / 58 v genes
    [91mmissing[0m 9 simulation genes (counts): [95mk[0m[91mv[0m[95m1[0m[95m-13[0m[93m02[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-33[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-39[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-9[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2[0m[95m-24[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2[0m[95m-30[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m4[0m[95m-1[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m6[0m[95m-21[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 52 / 52 v annotations (0 failed) with 7 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    running 10 procs for 52 seqs
    running 11 procs for 4 seqs
      info for 52 / 52 = 1.000   (removed: 0 failed)
      kept 14 (0.269) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 52 / 52 v annotations (0 failed) with 7 v genes in 0.1 sec
    running 10 procs for 52 seqs
    running 11 procs for 4 seqs
      info for 52 / 52 = 1.000   (removed: 0 failed)
      kept 14 (0.269) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igk/sw (0.7 sec)
    water time: 1.0  (ig-sw 0.7  processing 0.1)
  writing hmms (0.1 sec)
hmm
    reading output
        read 52 hmm output lines with 52 sequences in 52 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/hmm (0.5 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/true (0.5 sec)
         infra time: 1.1
      hmm step time: 1.4
  writing hmms (0.1 sec)
      total time: 3.1
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 4 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
  note: reducing N procs to the number of seqs 10 --> 4
caching parameters
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.0 sec
    keeping 2 / 70 v genes
    [91mmissing[0m 8 simulation genes (counts): [95ml[0m[91mv[0m[95m1[0m[95m-40[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m1[0m[95m-51[0m[93m02[0m 0  [95ml[0m[91mv[0m[95m2[0m[95m-23[0m[93m02[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-1[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-19[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-27[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m4[0m[95m-60[0m[93m03[0m 0  [95ml[0m[91mv[0m[95m8[0m[95m-61[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.0 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    running 4 procs for 4 seqs
      info for 4 / 4 = 1.000   (removed: 0 failed)
    water time: 0.0  (ig-sw 0.0  processing 0.0)
smith-waterman  (writing parameters)
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.0 sec
    running 4 procs for 4 seqs
      info for 4 / 4 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igl/sw (0.4 sec)
    water time: 0.5  (ig-sw 0.4  processing 0.0)
  writing hmms (0.1 sec)
hmm
    reading output
        read 4 hmm output lines with 4 sequences in 4 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/hmm (0.1 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/true (0.1 sec)
         infra time: 0.3
      hmm step time: 0.4
  writing hmms (0.1 sec)
      total time: 1.3
      total time: 8.1
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igh.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 52 / 52 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 52 / 52 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 20 (0.385) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 4192068443523205981-igh 4382644282309073191-igh
(0.0 sec)
        water time: 0.4
hmm
  caching all 52 naive sequences (0.3s)
   collapsed 52 queries into 18 clusters with identical naive seqs (0.0 sec)
  18 clusters with 10 procs (0.2s)
  17 clusters with 7 procs (0.3s)
  15 clusters with 5 procs (0.2s)
  13 clusters with 3 procs (0.2s)
  11 clusters with 2 procs (0.2s)
  10 clusters with 1 proc (0.3s)
      partition loop time: 1.4
getting annotations for final partition
  subcluster annotating 9 clusters with steps:  (0.3s) (0.2s) (0.2s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 4192068443523205981-igh 4382644282309073191-igh
(0.0 sec)

    subcluster annotation time 0.7
      total time: 3.0
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igk.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 52 / 52 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 52 / 52 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.269) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 3 queries with different true and inferred net shm indel lengths: 0515260043455636484-igk 2975541313160084247-igk 7675054709541274093-igk
(0.0 sec)
        water time: 0.3
hmm
  caching all 52 naive sequences (0.3s)
   collapsed 52 queries into 9 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 9
  9 clusters with 9 procs (0.2s)
  9 clusters with 6 procs (0.2s)
  9 clusters with 4 procs (0.2s)
  8 clusters with 3 procs (0.1s)
  7 clusters with 2 procs (0.1s)
  7 clusters with 1 proc (0.3s)
      partition loop time: 1.1
getting annotations for final partition
  subcluster annotating 7 clusters with steps:  (0.3s) (0.2s) (0.1s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 3 queries with different true and inferred net shm indel lengths: 7675054709541274093-igk 2975541313160084247-igk 0515260043455636484-igk
(0.0 sec)

    subcluster annotation time 0.6
      total time: 2.6
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igl.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 4 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
  note: reducing N procs to the number of seqs 10 --> 4
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 4 / 4 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
  plotting performance WARNING no values for sw-shm_indel_length in make_hist
  [93mwarning[0m total integral of 1 hists is zero, so not plotting anything
(0.0 sec)
        water time: 0.3
hmm
  caching all 4 naive sequences (0.1s)
   collapsed 4 queries into 3 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 4 --> 3
  3 clusters with 3 procs (0.1s)
  3 clusters with 2 procs (0.1s)
  3 clusters with 1 proc (0.1s)
      partition loop time: 0.3
getting annotations for final partition
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
  plotting performance WARNING no values for hmm-shm_indel_length in make_hist
  [93mwarning[0m total integral of 1 hists is zero, so not plotting anything
(0.0 sec)
      hmm step time: 0.1
      total time: 1.0
[44mcombining[0m chains
   cleaning pair info for 108 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
    truncating x bins 3 --> 12 and ybins 5 --> 12
    truncating x bins 6 --> 15 and ybins 10 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:      [93mwarning[0m adding missing per-seq key: mut_positions
  note: added 1 new input meta key to allowed keys (add 's'/plural to access it in the final annotations): mut_position (mut_positions)
13 total unpaired,  [94mh[0m 5  [95mk[0m 8
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    7 --> 11   [91m+4[0m
        [95mk[0m    6 --> 11   [91m+5[0m
    re-added unpaired seqs ([94mh[0m 5, [95mk[0m 8) to give total seqs in joint partitions: [94mh[0m 49  [95mk[0m 52
  [94mh[0m ccfs:     purity  completeness
      single   0.895  0.964
       joint   0.965  0.820
  [95mk[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  0.773
  merge time 0.0
  need to get annotations for 9/11 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 49 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml: paired-uids loci
  --input-partition-fname: read best partition with 49 sequences in 11 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 49 / 49 v annotations (0 failed) with 4 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 49 / 49 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 19 (0.388) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5280291432076549965-igh': [[u'5280291432076549965-igk', u'0500336466493698236-igh', u'0500336466493698236-igk']] --> [[u'5280291432076549965-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8776025731513881660-igh': [[u'0074724414294752202-igh', u'0074724414294752202-igk']] --> [[u'0074724414294752202-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2423526375406335118-igh': [[u'2423526375406335118-igk', u'8948680663041780753-igk']] --> [[u'8948680663041780753-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3333210634753180662-igh': [[u'0281360386959837356-igh', u'0281360386959837356-igk', u'3333210634753180662-igk']] --> [[u'3333210634753180662-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4435660559862607215-igh': [[u'4435660559862607215-igk', u'2318785112411412305-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0281360386959837356-igh': [[u'0281360386959837356-igk', u'3333210634753180662-igk', u'3333210634753180662-igh']] --> [[u'0281360386959837356-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8783159409729959662-igh': [[u'6449533098281318509-igh', u'6449533098281318509-igk', u'8783159409729959662-igk']] --> [[u'8783159409729959662-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0097328865434933074-igh': [[u'0097328865434933074-igk', u'1018631008044770831-igh', u'1018631008044770831-igk']] --> [[u'0097328865434933074-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6449533098281318509-igh': [[u'6449533098281318509-igk', u'8783159409729959662-igk', u'8783159409729959662-igh']] --> [[u'6449533098281318509-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '1018631008044770831-igh': [[u'0097328865434933074-igh', u'0097328865434933074-igk', u'1018631008044770831-igk']] --> [[u'1018631008044770831-igk']]
[93mwarning[0m replaced input metafo for 1 total key in 31 seqs (31 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0       49        0       49        0        0
             paired-uids        0       49        0       18        0       31
        water time: 0.0
hmm
  subcluster annotating 11 clusters with steps:  (0.3s) (0.1s) (0.1s) 
    subcluster annotation time 0.6
      total time: 0.7
  need to get annotations for 12/12 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml: paired-uids loci
  --input-partition-fname: read best partition with 52 sequences in 12 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 52 / 52 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 52 / 52 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.269) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5280291432076549965-igk': [[u'5280291432076549965-igh', u'0500336466493698236-igh', u'0500336466493698236-igk']] --> [[u'5280291432076549965-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0779828650680679142-igk': [[u'0355298415266930084-igk', u'0355298415266930084-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0074724414294752202-igk': [[u'8776025731513881660-igh', u'0074724414294752202-igh']] --> [[u'8776025731513881660-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8948680663041780753-igk': [[u'2423526375406335118-igh', u'2423526375406335118-igk']] --> [[u'2423526375406335118-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3333210634753180662-igk': [[u'0281360386959837356-igh', u'0281360386959837356-igk', u'3333210634753180662-igh']] --> [[u'3333210634753180662-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5144791312502540273-igk': [[u'3800059541212012373-igh', u'3800059541212012373-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0281360386959837356-igk': [[u'0281360386959837356-igh', u'3333210634753180662-igk', u'3333210634753180662-igh']] --> [[u'0281360386959837356-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8783159409729959662-igk': [[u'6449533098281318509-igh', u'6449533098281318509-igk', u'8783159409729959662-igh']] --> [[u'8783159409729959662-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0097328865434933074-igk': [[u'0097328865434933074-igh', u'1018631008044770831-igh', u'1018631008044770831-igk']] --> [[u'0097328865434933074-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6449533098281318509-igk': [[u'6449533098281318509-igh', u'8783159409729959662-igk', u'8783159409729959662-igh']] --> [[u'6449533098281318509-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 33 seqs (33 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0       52        0       52        0        0
             paired-uids        0       52        0       19        0       33
        water time: 0.0
hmm
  subcluster annotating 12 clusters with steps:  (0.3s) (0.1s) (0.1s) 
    subcluster annotation time 0.5
      total time: 0.7
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  6 total unpaired,  [94mh[0m 5  [92ml[0m 1
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    2 --> 2   
        [92ml[0m    2 --> 2   
    re-added unpaired seqs ([94mh[0m 5, [92ml[0m 1) to give total seqs in joint partitions: [94mh[0m 8  [92ml[0m 4
    [93mwarning[0m added 5 / 8 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
  [94mh[0m ccfs:     purity  completeness
      single   0.895  0.964
       joint   0.750  1.000
  [92ml[0m ccfs:     purity  completeness
      single   0.750  1.000
       joint   0.750  1.000
  merge time 0.0
  need to get annotations for 3/5 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 8 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml: paired-uids loci
  note: reducing N procs to the number of seqs 10 --> 8
  --input-partition-fname: read best partition with 8 sequences in 5 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 8 / 8 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 8 / 8 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 2 (0.250) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4763052786909081584-igh': [[u'8391502891759535125-igk', u'8391502891759535125-igh', u'4763052786909081584-igl']] --> [[u'4763052786909081584-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2700987964304914088-igh': [[u'2700987964304914088-igl', u'3545959358794279649-igh', u'3545959358794279649-igk']] --> [[u'2700987964304914088-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6651204747438137634-igh': [[u'6651204747438137634-igk', u'6923639371550243098-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4435660559862607215-igh': [[u'4435660559862607215-igk', u'2318785112411412305-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0074724414294752202-igh': [[u'8776025731513881660-igh', u'0074724414294752202-igk']] --> [[]]
[93mwarning[0m replaced input metafo for 1 total key in 5 seqs (5 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0        8        0        8        0        0
             paired-uids        0        8        0        3        0        5
        water time: 0.0
hmm
    reading output
        read 5 hmm output lines with 8 sequences in 5 events  (0 failures)
      hmm step time: 0.1
      total time: 0.2
  need to get annotations for 2/2 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  --input-metafnames: added meta info for 4 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml: paired-uids loci
  note: reducing N procs to the number of seqs 10 --> 4
  --input-partition-fname: read best partition with 4 sequences in 2 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 4 / 4 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4763052786909081584-igl': [[u'8391502891759535125-igk', u'8391502891759535125-igh', u'4763052786909081584-igh']] --> [[u'4763052786909081584-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2700987964304914088-igl': [[u'2700987964304914088-igh', u'3545959358794279649-igh', u'3545959358794279649-igk']] --> [[u'2700987964304914088-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 2 seqs (2 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0        4        0        4        0        0
             paired-uids        0        4        0        2        0        2
        water time: 0.0
hmm
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
      hmm step time: 0.1
      total time: 0.2
   N clusters with all seqs:
        [94mh[0m    9 --> 13   [91m+4[0m
        [95mk[0m    7 --> 12   [91m+5[0m
        [92ml[0m    2 --> 2   
      total time: 12.3
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --max-ccf-fail-frac 0.10 --is-simu --seed-unique-id 5832061506299130409-igh:5832061506299130409-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m       52       36        13     0        4       7   0.135    [92m-[0m
             [95mk[0m       52       36        13     0        3       6   0.115    [92m-[0m
     adding seqs paired with uids we kept
           locus  before  added  after  kept frac
             [94mh[0m       7       4     11    0.212
             [95mk[0m       6       5     11    0.212
             [92ml[0m       0       0      0    0.000
      taken 13, paired with taken 9 (total 22)
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 11 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 11 / 11 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 11 / 11 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 4 (0.364) unproductive
        water time: 0.0
hmm
  caching all 11 naive sequences (0.1s)
   collapsed 11 queries into 4 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 4
  4 clusters with 4 procs (0.1s)
  4 clusters with 3 procs (0.1s)
  4 clusters with 2 procs (0.1s)
  4 clusters with 1 proc (0.2s)
      partition loop time: 0.5
getting annotations for final partition
  subcluster annotating 3 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.3
      total time: 1.0
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 11 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 11 / 11 v annotations (0 failed) with 4 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 11 / 11 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 2 (0.182) unproductive
        water time: 0.0
hmm
  caching all 11 naive sequences (0.1s)
   collapsed 11 queries into 5 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 5
  5 clusters with 5 procs (0.1s)
  5 clusters with 3 procs (0.1s)
  5 clusters with 2 procs (0.1s)
  5 clusters with 1 proc (0.2s)
      partition loop time: 0.5
getting annotations for final partition
  subcluster annotating 4 clusters with steps:  (0.1s) (0.1s) 
    subcluster annotation time 0.2
      total time: 1.0
[94migl[0m: input file missing, skipping partition (test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/single-chain/input-seqs-igl.fa)
[44mcombining[0m chains
    [93mwarning[0m zero length annotation list in check_concordance_of_cpath_and_annotations()
   cleaning pair info for 22 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:      [93mwarning[0m adding missing per-seq key: mut_positions
  note: added 1 new input meta key to allowed keys (add 's'/plural to access it in the final annotations): mut_position (mut_positions)
4 total unpaired,  [94mh[0m 2  [95mk[0m 2
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    3 --> 4    [91m+1[0m
        [95mk[0m    3 --> 4    [91m+1[0m
    re-added unpaired seqs ([94mh[0m 2, [95mk[0m 2) to give total seqs in joint partitions: [94mh[0m 11  [95mk[0m 11
    [93mwarning[0m removed 41/52 uids (leaving 11) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 38/49 uids (leaving 11) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [94mh[0m ccfs:     purity  completeness
      single   0.714  1.000
       joint   1.000  1.000
    [93mwarning[0m removed 41/52 uids (leaving 11) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 41/52 uids (leaving 11) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  0.833
  merge time 0.0
     removed 3 unseeded clusters (of 4 total, leaving 1) from igh joint partition
  need to get annotations for 1/1 joint igh clusters
  seed cluster size in best joint partition: 5, excluding seed seq: 4
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 5832061506299130409-igh:5832061506299130409-igk
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 5 sequences from test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/meta-igh.yaml: paired-uids loci
  note: reducing N procs to the number of seqs 10 --> 5
  --input-partition-fname: read best partition with 5 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 5 / 5 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 5 / 5 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 4 (0.800) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2423526375406335118-igh': [[u'2423526375406335118-igk', u'8948680663041780753-igk']] --> [[u'2423526375406335118-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6651204747438137634-igh': [[u'6651204747438137634-igk', u'6923639371550243098-igh']] --> [[u'6651204747438137634-igk']]
[93mwarning[0m replaced input metafo for 1 total key in 2 seqs (2 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0        5        0        5        0        0
             paired-uids        0        5        0        3        0        2
        water time: 0.0
hmm
  subcluster annotating 1 cluster with steps:  (0.1s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.3
     removed 4 unseeded clusters (of 5 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 5, excluding seed seq: 4
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 5832061506299130409-igh:5832061506299130409-igk
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 5 sequences from test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/meta-igk.yaml: paired-uids loci
  note: reducing N procs to the number of seqs 10 --> 5
  --input-partition-fname: read best partition with 5 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/5832061506299130409-igh+5832061506299130409-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 5 / 5 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 5 / 5 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 1 (0.200) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2423526375406335118-igk': [[u'2423526375406335118-igh', u'8948680663041780753-igk']] --> [[u'2423526375406335118-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6651204747438137634-igk': [[u'6923639371550243098-igh', u'6651204747438137634-igh']] --> [[u'6651204747438137634-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 2 seqs (2 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0        5        0        5        0        0
             paired-uids        0        5        0        3        0        2
        water time: 0.0
hmm
  subcluster annotating 1 cluster with steps:  (0.1s) (0.1s) 
    subcluster annotation time 0.2
      total time: 0.3
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    no single chain output
   N clusters with all seqs:
        [94mh[0m    3 --> 1    [91m-2[0m
        [95mk[0m    4 --> 1    [91m-3[0m
      total time: 4.0
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --existing-output-run-cfg paired --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 2 clusters with sizes: 16 12
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/134364/fasttree.out /tmp/dralph/tree-inference/134364/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/847433/fasttree.out /tmp/dralph/tree-inference/847433/input-seqs.fa
      made 2 fasttree trees (0.2s)
    tree origins: 2 ran fasttree
    calculating selection metrics for 2 clusters with sizes: 16 12
      skipping 9 smaller than 10
      setting default tau to 1 / 364 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 2/18 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: elx
      setting default tau to 1 / 364 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0027
                [94miclust 1: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 4/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.012  mfreq 0.010  diff 0.002  abs(frac diff) 22%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0070    0.0052       1.3     0.0018     4350110702177329894-igh
              0.0070    0.0052       1.3     0.0018     5465202414905022249-igh
              0.0070    0.0052       1.3     0.0018     0074724414294752202-igh
              0.0069    0.0052       1.3     0.0016     5493067941430287737-igh
          10 with highest+lowest ratios:
              0.0070    0.0052       1.3     0.0018     4350110702177329894-igh
              0.0070    0.0052       1.3     0.0018     5465202414905022249-igh
              0.0070    0.0052       1.3     0.0018     0074724414294752202-igh
              0.0069    0.0052       1.3     0.0016     5493067941430287737-igh
              0.0069    0.0052       1.3     0.0016     5493067941430287737-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 21/23 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: afh crw hlw cij gjr gjo ivw ekv gwy bis
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 0.3
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 2 clusters with sizes: 15 11
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/134364/fasttree.out /tmp/dralph/tree-inference/134364/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/847433/fasttree.out /tmp/dralph/tree-inference/847433/input-seqs.fa
      made 2 fasttree trees (0.1s)
    tree origins: 2 ran fasttree
    calculating selection metrics for 2 clusters with sizes: 15 11
      skipping 10 smaller than 10
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 15/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: gjo ivw afh crw hlw cij gwy
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
  no annotations for selection metrics
      total time: 0.0
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
  no annotations for selection metrics
      total time: 0.0
[44mgetting combined h/l selection metrics[0m
    igh+igk: 10 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 9 annotations with N h or l ids < 10
    igh+igl: 2 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 3 annotations with zero length paired uids
    igh+igl: skipped 2 annotations with N h or l ids < 10
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3800059541212012373-igh 3800059541212012373-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2975541313160084247-igh 4192068443523205981-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6283294071599125022-igh 6283294071599125022-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8783159409729959662-igh 8783159409729959662-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 1018631008044770831-igh 1018631008044770831-igk
            cons seq not observed
        less than 0.75 (3 / 12 = 0.25) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (2 / 11 = 0.18) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 9185758573158687777-igh 9185758573158687777-igk
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 2 clusters with sizes: 15 11
      all fasttree outputs exist, not rerunning (e.g. test/paired/new-results/partition-new-simu/fasttree/iclust-0/fasttree.out)
    tree origins: 2 ran fasttree
    calculating selection metrics for 2 clusters with sizes: 15 11
      skipping 0 smaller than 10
      setting default tau to 1 / 705 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0014
      setting default tau to 1 / 705 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0014
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: coq kpu lqu act ewy dmu emr cix fju efg
  writing selection metrics to test/paired/new-results/partition-new-simu/selection-metrics.yaml
      writing 10 chosen abs to test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 1.8
